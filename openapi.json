{"openapi":"3.1.0","info":{"title":"AI Secretary System","description":"AI秘書システム - メール・LINE仲介、物品購入、支払い自動化","version":"0.1.0"},"paths":{"/api/v1/wish":{"post":{"summary":"Process Wish","description":"ユーザーの「○○したい」という願望を処理\nAIエージェントが提案を生成し、必要に応じて実行\n\ntoolsパラメータで使用するツールを明示的に指定できます:\n- browse_website: Webサイトの閲覧\n- fill_form: フォームの入力\n- click_element: Web要素のクリック\n- take_screenshot: スクリーンショット取得\n- send_email: メール送信\n- search_email: メール検索\n- read_email: メール読み取り\n- send_line_message: LINEメッセージ送信\n- search_web: Web検索","operationId":"process_wish_api_v1_wish_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/WishRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/WishResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/task/{id}/revise":{"post":{"summary":"Revise Task","description":"タスクの提案を訂正\n\n既存のタスクに対して訂正リクエストを送り、新しい提案を生成します。\n例: \"17時じゃなくて16時にして\", \"グリーン車にして\", \"予算は30万円で\"","operationId":"revise_task_api_v1_task__id__revise_post","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","title":"Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReviseRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/WishResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/task/{id}/confirm":{"post":{"summary":"Confirm Task","description":"タスクの実行を確認・承認","operationId":"confirm_task_api_v1_task__id__confirm_post","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","title":"Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/task/{id}":{"get":{"summary":"Get Task Status","description":"タスクのステータスを取得","operationId":"get_task_status_api_v1_task__id__get","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","title":"Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/tasks":{"get":{"summary":"List Tasks","description":"タスク一覧を取得","operationId":"list_tasks_api_v1_tasks_get","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":10,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/task/{id}/provide-credentials":{"post":{"summary":"Provide Credentials","description":"タスク実行中に認証情報を提供（ログインまたは新規登録）\n\nユーザーフロー：\n1. execution-statusで status=\"awaiting_credentials\" の場合、auth_options が返される\n2. auth_options.login_fields でログインフォームを表示\n3. auth_options.registration_fields で新規登録フォームを表示（自動生成パスワード付き）\n4. ユーザーが選択したフローに応じて is_new_registration を設定\n\nRequest（ログインの場合）:\n```json\n{\n  \"service\": \"willer\",\n  \"credentials\": {\"email\": \"user@example.com\", \"password\": \"secret123\"},\n  \"save_credentials\": true,\n  \"is_new_registration\": false\n}\n```\n\nRequest（新規登録の場合）:\n```json\n{\n  \"service\": \"willer\",\n  \"credentials\": {\"email\": \"new@example.com\", \"password\": \"AutoGenPass123\"},\n  \"save_credentials\": true,\n  \"is_new_registration\": true\n}\n```","operationId":"provide_credentials_api_v1_task__id__provide_credentials_post","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","title":"Id"}},{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProvideCredentialsRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProvideCredentialsResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/task/{id}/execution-status":{"get":{"summary":"Get Execution Status","description":"実行状況をリアルタイム取得（ポーリング用）\n\nResponse:\n```json\n{\n  \"task_id\": \"uuid\",\n  \"status\": \"executing\",\n  \"progress\": {\n    \"current_step\": \"logging_in\",\n    \"steps_completed\": [\"opened_url\", \"entered_credentials\"],\n    \"steps_remaining\": [\"submit_form\", \"confirm_booking\"],\n    \"screenshot_url\": \"/screenshots/task_xxx_step2.png\"\n  }\n}\n```","operationId":"get_execution_status_api_v1_task__id__execution_status_get","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","title":"Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExecutionStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chat/register":{"post":{"tags":["chat"],"summary":"Register","description":"Register a new user","operationId":"register_api_v1_chat_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chat/login":{"post":{"tags":["chat"],"summary":"Login","description":"Login and get JWT token","operationId":"login_api_v1_chat_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chat/me":{"get":{"tags":["chat"],"summary":"Get Me","description":"Get current user profile","operationId":"get_me_api_v1_chat_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}}},"security":[{"HTTPBearer":[]}]},"patch":{"tags":["chat"],"summary":"Update Me","description":"Update current user profile","operationId":"update_me_api_v1_chat_me_patch","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserUpdateRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/chat/invite":{"post":{"tags":["chat"],"summary":"Create Invite","description":"Create an invite link","operationId":"create_invite_api_v1_chat_invite_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/InviteCreateRequest","default":{"max_uses":1,"expires_in_hours":24}}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InviteResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/chat/invite/{code}":{"get":{"tags":["chat"],"summary":"Get Invite","description":"Get invite information","operationId":"get_invite_api_v1_chat_invite__code__get","parameters":[{"name":"code","in":"path","required":true,"schema":{"type":"string","title":"Code"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InviteInfoResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chat/invite/{code}/accept":{"post":{"tags":["chat"],"summary":"Accept Invite","description":"Accept an invite and become friends","operationId":"accept_invite_api_v1_chat_invite__code__accept_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"code","in":"path","required":true,"schema":{"type":"string","title":"Code"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InviteAcceptResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chat/friends":{"get":{"tags":["chat"],"summary":"Get Friends","description":"Get friends list","operationId":"get_friends_api_v1_chat_friends_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FriendsListResponse"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/chat/friends/{friend_id}":{"delete":{"tags":["chat"],"summary":"Delete Friend","description":"Delete a friend","operationId":"delete_friend_api_v1_chat_friends__friend_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"friend_id","in":"path","required":true,"schema":{"type":"string","title":"Friend Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chat/rooms":{"get":{"tags":["chat"],"summary":"Get Rooms","description":"Get chat rooms","operationId":"get_rooms_api_v1_chat_rooms_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoomsListResponse"}}}}},"security":[{"HTTPBearer":[]}]},"post":{"tags":["chat"],"summary":"Create Room","description":"Create a group chat room","operationId":"create_room_api_v1_chat_rooms_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoomCreateRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoomResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/chat/rooms/{room_id}":{"get":{"tags":["chat"],"summary":"Get Room","description":"Get room details","operationId":"get_room_api_v1_chat_rooms__room_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"room_id","in":"path","required":true,"schema":{"type":"string","title":"Room Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoomResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["chat"],"summary":"Update Room","description":"Update room settings","operationId":"update_room_api_v1_chat_rooms__room_id__patch","security":[{"HTTPBearer":[]}],"parameters":[{"name":"room_id","in":"path","required":true,"schema":{"type":"string","title":"Room Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoomUpdateRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoomResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chat/rooms/{room_id}/members":{"get":{"tags":["chat"],"summary":"Get Room Members","description":"Get room members","operationId":"get_room_members_api_v1_chat_rooms__room_id__members_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"room_id","in":"path","required":true,"schema":{"type":"string","title":"Room Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoomMembersListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["chat"],"summary":"Add Room Member","description":"Add a member to the room","operationId":"add_room_member_api_v1_chat_rooms__room_id__members_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"room_id","in":"path","required":true,"schema":{"type":"string","title":"Room Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AddMemberRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoomMemberResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chat/rooms/{room_id}/messages":{"get":{"tags":["chat"],"summary":"Get Messages","description":"Get messages from a room","operationId":"get_messages_api_v1_chat_rooms__room_id__messages_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"room_id","in":"path","required":true,"schema":{"type":"string","title":"Room Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Limit"}},{"name":"before","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Before"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessagesListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["chat"],"summary":"Send Message","description":"Send a message to a room","operationId":"send_message_api_v1_chat_rooms__room_id__messages_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"room_id","in":"path","required":true,"schema":{"type":"string","title":"Room Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageSendRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chat/rooms/{room_id}/read":{"post":{"tags":["chat"],"summary":"Mark As Read","description":"Mark messages as read","operationId":"mark_as_read_api_v1_chat_rooms__room_id__read_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"room_id","in":"path","required":true,"schema":{"type":"string","title":"Room Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReadMarkResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chat/rooms/{room_id}/ai":{"get":{"tags":["chat"],"summary":"Get Ai Settings","description":"Get AI settings for a room","operationId":"get_ai_settings_api_v1_chat_rooms__room_id__ai_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"room_id","in":"path","required":true,"schema":{"type":"string","title":"Room Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AISettingsResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["chat"],"summary":"Update Ai Settings","description":"Update AI settings for a room","operationId":"update_ai_settings_api_v1_chat_rooms__room_id__ai_patch","security":[{"HTTPBearer":[]}],"parameters":[{"name":"room_id","in":"path","required":true,"schema":{"type":"string","title":"Room Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AISettingsUpdateRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AISettingsResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chat/rooms/{room_id}/ai/summary":{"get":{"tags":["chat"],"summary":"Get Ai Summary","description":"Get AI summary of recent conversation","operationId":"get_ai_summary_api_v1_chat_rooms__room_id__ai_summary_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"room_id","in":"path","required":true,"schema":{"type":"string","title":"Room Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AISummaryResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/credentials":{"post":{"summary":"Save Credentials","description":"認証情報を暗号化して保存\n\nRequest:\n```json\n{\n  \"service\": \"ex_reservation\",\n  \"credentials\": {\n    \"email\": \"user@example.com\",\n    \"password\": \"secret123\"\n  }\n}\n```\n\nResponse:\n```json\n{\n  \"success\": true,\n  \"service\": \"ex_reservation\",\n  \"message\": \"認証情報を保存しました\"\n}\n```","operationId":"save_credentials_api_v1_credentials_post","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CredentialRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CredentialResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"summary":"List Credentials","description":"保存済みサービス一覧を取得\n\nResponse:\n```json\n{\n  \"services\": [\n    {\n      \"service\": \"ex_reservation\",\n      \"created_at\": \"2024-12-21T10:00:00Z\",\n      \"updated_at\": \"2024-12-21T10:00:00Z\"\n    },\n    {\n      \"service\": \"amazon\",\n      \"created_at\": \"2024-12-20T09:00:00Z\",\n      \"updated_at\": null\n    }\n  ]\n}\n```","operationId":"list_credentials_api_v1_credentials_get","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CredentialListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/credentials/{service}":{"delete":{"summary":"Delete Credentials","description":"認証情報を削除\n\nResponse:\n```json\n{\n  \"success\": true,\n  \"service\": \"ex_reservation\",\n  \"message\": \"認証情報を削除しました\"\n}\n```","operationId":"delete_credentials_api_v1_credentials__service__delete","parameters":[{"name":"service","in":"path","required":true,"schema":{"type":"string","title":"Service"}},{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CredentialResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/gmail/setup":{"post":{"tags":["gmail"],"summary":"Gmail Setup","description":"Gmail OAuth2認証を開始\n\n認証URLを返すので、ユーザーにそのURLにアクセスさせてGmail連携を許可してもらう","operationId":"gmail_setup_api_v1_gmail_setup_post","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GmailSetupResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/gmail/callback":{"get":{"tags":["gmail"],"summary":"Gmail Callback","description":"Gmail OAuth2コールバック（GETリダイレクト用）\n\nGoogleからリダイレクトされてきた時に呼ばれる","operationId":"gmail_callback_api_v1_gmail_callback_get","parameters":[{"name":"code","in":"query","required":true,"schema":{"type":"string","description":"Authorization code from Google","title":"Code"},"description":"Authorization code from Google"},{"name":"state","in":"query","required":true,"schema":{"type":"string","description":"User ID passed as state","title":"State"},"description":"User ID passed as state"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["gmail"],"summary":"Gmail Callback Post","description":"Gmail OAuth2コールバック（POST用）\n\nフロントエンドからコードを送信する場合に使用","operationId":"gmail_callback_post_api_v1_gmail_callback_post","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GmailCallbackRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GmailCallbackResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/gmail/status":{"get":{"tags":["gmail"],"summary":"Gmail Status","description":"Gmail連携状態を確認","operationId":"gmail_status_api_v1_gmail_status_get","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GmailStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/gmail/sync":{"post":{"tags":["gmail"],"summary":"Gmail Sync","description":"手動でメール同期を実行\n\n新着の未読メールを取得してdetected_messagesに保存","operationId":"gmail_sync_api_v1_gmail_sync_post","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id"}},{"name":"max_results","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"最大取得件数","default":50,"title":"Max Results"},"description":"最大取得件数"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GmailSyncResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/gmail/disconnect":{"delete":{"tags":["gmail"],"summary":"Gmail Disconnect","description":"Gmail連携を解除","operationId":"gmail_disconnect_api_v1_gmail_disconnect_delete","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GmailDisconnectResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/detection/messages":{"get":{"tags":["detection"],"summary":"List Detected Messages","description":"検知メッセージ一覧を取得\n\nフィルタ:\n- source: done_chat, gmail, line\n- status: pending, processing, processed, failed\n- content_type: invoice, otp, notification, general","operationId":"list_detected_messages_api_v1_detection_messages_get","parameters":[{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id"}},{"name":"source","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/MessageSource"},{"type":"null"}],"title":"Source"}},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/DetectionStatus"},{"type":"null"}],"title":"Status"}},{"name":"content_type","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/ContentType"},{"type":"null"}],"title":"Content Type"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"default":50,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","minimum":0,"default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DetectedMessagesListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/detection/messages/{message_id}":{"get":{"tags":["detection"],"summary":"Get Detected Message","description":"検知メッセージを取得","operationId":"get_detected_message_api_v1_detection_messages__message_id__get","parameters":[{"name":"message_id","in":"path","required":true,"schema":{"type":"string","title":"Message Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DetectedMessageResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/detection/messages/{message_id}/attachments":{"get":{"tags":["detection"],"summary":"List Message Attachments","description":"検知メッセージの添付ファイル一覧を取得","operationId":"list_message_attachments_api_v1_detection_messages__message_id__attachments_get","parameters":[{"name":"message_id","in":"path","required":true,"schema":{"type":"string","title":"Message Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AttachmentsListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/detection/messages/{message_id}/download-attachments":{"post":{"tags":["detection"],"summary":"Download Message Attachments","description":"Gmailメッセージの添付ファイルをダウンロード・保存\n\nGmail連携済みの場合、メッセージの添付ファイルをダウンロードしてローカルに保存","operationId":"download_message_attachments_api_v1_detection_messages__message_id__download_attachments_post","parameters":[{"name":"message_id","in":"path","required":true,"schema":{"type":"string","title":"Message Id"}},{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AttachmentsListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/detection/attachments/{attachment_id}":{"get":{"tags":["detection"],"summary":"Download Attachment","description":"添付ファイルをダウンロード","operationId":"download_attachment_api_v1_detection_attachments__attachment_id__get","parameters":[{"name":"attachment_id","in":"path","required":true,"schema":{"type":"string","title":"Attachment Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["detection"],"summary":"Delete Attachment","description":"添付ファイルを削除","operationId":"delete_attachment_api_v1_detection_attachments__attachment_id__delete","parameters":[{"name":"attachment_id","in":"path","required":true,"schema":{"type":"string","title":"Attachment Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/detection/attachments/{attachment_id}/info":{"get":{"tags":["detection"],"summary":"Get Attachment Info","description":"添付ファイル情報を取得","operationId":"get_attachment_info_api_v1_detection_attachments__attachment_id__info_get","parameters":[{"name":"attachment_id","in":"path","required":true,"schema":{"type":"string","title":"Attachment Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AttachmentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/content/extract/pdf":{"post":{"tags":["content-intelligence"],"summary":"Extract Text From Pdf","description":"PDFファイルからテキストを抽出\n\n- **file**: PDFファイル\n- **classify**: 分類も行うかどうか（デフォルト: True）","operationId":"extract_text_from_pdf_api_v1_content_extract_pdf_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_extract_text_from_pdf_api_v1_content_extract_pdf_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalyzeContentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/content/extract/image":{"post":{"tags":["content-intelligence"],"summary":"Extract Text From Image","description":"画像ファイルからテキストを抽出（OCR）\n\n- **file**: 画像ファイル（PNG, JPEG, GIF）\n- **language**: OCR言語（デフォルト: jpn+eng）\n- **classify**: 分類も行うかどうか（デフォルト: True）","operationId":"extract_text_from_image_api_v1_content_extract_image_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_extract_text_from_image_api_v1_content_extract_image_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalyzeContentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/content/extract/url":{"post":{"tags":["content-intelligence"],"summary":"Extract Text From Url","description":"URLにアクセスしてテキストコンテンツを取得\n\n- **url**: 取得するURL\n- **wait_for_selector**: 待機するCSSセレクタ（オプション）\n- **timeout_ms**: タイムアウト（ミリ秒、デフォルト: 30000）","operationId":"extract_text_from_url_api_v1_content_extract_url_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExtractTextFromURLRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExtractTextFromURLResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/content/classify":{"post":{"tags":["content-intelligence"],"summary":"Classify Content","description":"テキストをカテゴリ分類\n\n- **text**: 分類するテキスト\n- **subject**: 件名（オプション）\n- **sender**: 送信者（オプション）","operationId":"classify_content_api_v1_content_classify_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ClassifyContentRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ClassifyContentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/content/analyze/attachment/{attachment_id}":{"post":{"tags":["content-intelligence"],"summary":"Analyze Attachment","description":"保存済み添付ファイルを解析\n\n- **attachment_id**: 添付ファイルID\n- **classify**: 分類も行うかどうか（デフォルト: True）","operationId":"analyze_attachment_api_v1_content_analyze_attachment__attachment_id__post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"attachment_id","in":"path","required":true,"schema":{"type":"string","title":"Attachment Id"}},{"name":"classify","in":"query","required":false,"schema":{"type":"boolean","default":true,"title":"Classify"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalyzeContentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/content/analyze/message/{message_id}":{"post":{"tags":["content-intelligence"],"summary":"Analyze Detected Message","description":"検知メッセージを解析・分類\n\n- **message_id**: 検知メッセージID\n- **include_attachments**: 添付ファイルも処理するか（デフォルト: True）","operationId":"analyze_detected_message_api_v1_content_analyze_message__message_id__post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"message_id","in":"path","required":true,"schema":{"type":"string","title":"Message Id"}},{"name":"include_attachments","in":"query","required":false,"schema":{"type":"boolean","default":true,"title":"Include Attachments"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/content/analyze/batch":{"post":{"tags":["content-intelligence"],"summary":"Batch Analyze Messages","description":"複数の検知メッセージをバッチ解析\n\n- **message_ids**: 解析するメッセージIDのリスト","operationId":"batch_analyze_messages_api_v1_content_analyze_batch_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchAnalyzeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchAnalyzeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/webhook/line":{"post":{"summary":"Line Webhook","description":"LINEからのWebhookを処理","operationId":"line_webhook_webhook_line_post","parameters":[{"name":"x-line-signature","in":"header","required":false,"schema":{"type":"string","title":"X-Line-Signature"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Root","description":"ヘルスチェック用エンドポイント","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health":{"get":{"summary":"Health Check","description":"詳細なヘルスチェック","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"AIMode":{"type":"string","enum":["off","assist","auto"],"title":"AIMode","description":"AI Mode options"},"AISettingsResponse":{"properties":{"room_id":{"type":"string","title":"Room Id"},"enabled":{"type":"boolean","title":"Enabled"},"mode":{"$ref":"#/components/schemas/AIMode"},"personality":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Personality"},"auto_reply_delay_ms":{"type":"integer","title":"Auto Reply Delay Ms"}},"type":"object","required":["room_id","enabled","mode","auto_reply_delay_ms"],"title":"AISettingsResponse","description":"AI settings response"},"AISettingsUpdateRequest":{"properties":{"enabled":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Enabled"},"mode":{"anyOf":[{"$ref":"#/components/schemas/AIMode"},{"type":"null"}]},"personality":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Personality"},"auto_reply_delay_ms":{"anyOf":[{"type":"integer","maximum":30000.0,"minimum":0.0},{"type":"null"}],"title":"Auto Reply Delay Ms"}},"type":"object","title":"AISettingsUpdateRequest","description":"Update AI settings request"},"AISummaryResponse":{"properties":{"summary":{"type":"string","title":"Summary"},"message_count":{"type":"integer","title":"Message Count"},"last_message_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Message At"}},"type":"object","required":["summary","message_count"],"title":"AISummaryResponse","description":"AI summary response"},"AddMemberRequest":{"properties":{"user_id":{"type":"string","title":"User Id"}},"type":"object","required":["user_id"],"title":"AddMemberRequest","description":"Add member request"},"AnalyzeContentResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"extraction_result":{"anyOf":[{"$ref":"#/components/schemas/TextExtractionResult"},{"type":"null"}]},"classification_result":{"anyOf":[{"$ref":"#/components/schemas/ClassificationResult"},{"type":"null"}]},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"processing_time_ms":{"type":"integer","title":"Processing Time Ms"}},"type":"object","required":["success","processing_time_ms"],"title":"AnalyzeContentResponse","description":"コンテンツ解析APIレスポンス"},"AttachmentResponse":{"properties":{"filename":{"type":"string","title":"Filename"},"mime_type":{"type":"string","title":"Mime Type"},"file_size":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"File Size"},"id":{"type":"string","title":"Id"},"detected_message_id":{"type":"string","title":"Detected Message Id"},"storage_type":{"$ref":"#/components/schemas/StorageType"},"checksum":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Checksum"},"extracted_text":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Extracted Text"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["filename","mime_type","id","detected_message_id","storage_type","created_at"],"title":"AttachmentResponse","description":"添付ファイルレスポンス"},"AttachmentsListResponse":{"properties":{"attachments":{"items":{"$ref":"#/components/schemas/AttachmentResponse"},"type":"array","title":"Attachments"}},"type":"object","required":["attachments"],"title":"AttachmentsListResponse","description":"添付ファイル一覧レスポンス"},"AuthFieldInfo":{"properties":{"name":{"type":"string","title":"Name"},"label":{"type":"string","title":"Label"},"type":{"type":"string","title":"Type"},"required":{"type":"boolean","title":"Required","default":true},"placeholder":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Placeholder"},"default_value":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Default Value"}},"type":"object","required":["name","label","type"],"title":"AuthFieldInfo","description":"フロントエンド表示用の認証フィールド情報"},"AuthOptions":{"properties":{"service":{"type":"string","title":"Service"},"service_display_name":{"type":"string","title":"Service Display Name"},"login_fields":{"items":{"$ref":"#/components/schemas/AuthFieldInfo"},"type":"array","title":"Login Fields"},"login_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Login Url"},"registration_fields":{"items":{"$ref":"#/components/schemas/AuthFieldInfo"},"type":"array","title":"Registration Fields"},"registration_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Registration Url"},"generated_password":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Generated Password"}},"type":"object","required":["service","service_display_name"],"title":"AuthOptions","description":"認証オプション（ログイン or 新規登録）"},"BatchAnalyzeRequest":{"properties":{"message_ids":{"items":{"type":"string"},"type":"array","title":"Message Ids"}},"type":"object","required":["message_ids"],"title":"BatchAnalyzeRequest","description":"バッチ解析リクエスト"},"BatchAnalyzeResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"total":{"type":"integer","title":"Total"},"processed":{"type":"integer","title":"Processed"},"failed":{"type":"integer","title":"Failed"},"results":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Results"}},"type":"object","required":["success","total","processed","failed","results"],"title":"BatchAnalyzeResponse","description":"バッチ解析レスポンス"},"Body_extract_text_from_image_api_v1_content_extract_image_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"language":{"type":"string","title":"Language","default":"jpn+eng"},"classify":{"type":"boolean","title":"Classify","default":true}},"type":"object","required":["file"],"title":"Body_extract_text_from_image_api_v1_content_extract_image_post"},"Body_extract_text_from_pdf_api_v1_content_extract_pdf_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"classify":{"type":"boolean","title":"Classify","default":true}},"type":"object","required":["file"],"title":"Body_extract_text_from_pdf_api_v1_content_extract_pdf_post"},"ClassificationResult":{"properties":{"category":{"$ref":"#/components/schemas/ContentCategory"},"confidence":{"$ref":"#/components/schemas/ContentConfidence"},"confidence_score":{"type":"number","maximum":1.0,"minimum":0.0,"title":"Confidence Score"},"reasoning":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Reasoning"},"extracted_data":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Extracted Data"},"secondary_categories":{"anyOf":[{"items":{"$ref":"#/components/schemas/ContentCategory"},"type":"array"},{"type":"null"}],"title":"Secondary Categories"}},"type":"object","required":["category","confidence","confidence_score"],"title":"ClassificationResult","description":"コンテンツ分類結果"},"ClassifyContentRequest":{"properties":{"text":{"type":"string","title":"Text"},"subject":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Subject"},"sender":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sender"}},"type":"object","required":["text"],"title":"ClassifyContentRequest","description":"コンテンツ分類APIリクエスト"},"ClassifyContentResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"result":{"anyOf":[{"$ref":"#/components/schemas/ClassificationResult"},{"type":"null"}]},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"ClassifyContentResponse","description":"コンテンツ分類APIレスポンス"},"ContentCategory":{"type":"string","enum":["invoice","receipt","notification","otp","confirmation","newsletter","personal","spam","unknown"],"title":"ContentCategory","description":"コンテンツカテゴリ"},"ContentConfidence":{"type":"string","enum":["high","medium","low","uncertain"],"title":"ContentConfidence","description":"分類信頼度レベル"},"ContentType":{"type":"string","enum":["invoice","otp","notification","general"],"title":"ContentType","description":"コンテンツの分類"},"CredentialListItem":{"properties":{"service":{"type":"string","title":"Service"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Updated At"}},"type":"object","required":["service","created_at"],"title":"CredentialListItem","description":"保存済み認証情報一覧の項目"},"CredentialListResponse":{"properties":{"services":{"items":{"$ref":"#/components/schemas/CredentialListItem"},"type":"array","title":"Services"}},"type":"object","required":["services"],"title":"CredentialListResponse","description":"保存済み認証情報一覧レスポンス"},"CredentialRequest":{"properties":{"service":{"type":"string","title":"Service"},"credentials":{"additionalProperties":{"type":"string"},"type":"object","title":"Credentials"}},"type":"object","required":["service","credentials"],"title":"CredentialRequest","description":"認証情報保存リクエスト"},"CredentialResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"service":{"type":"string","title":"Service"},"message":{"type":"string","title":"Message"}},"type":"object","required":["success","service","message"],"title":"CredentialResponse","description":"認証情報レスポンス"},"DetectedMessageResponse":{"properties":{"source":{"$ref":"#/components/schemas/MessageSource"},"source_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Source Id"},"content":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Content"},"subject":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Subject"},"sender_info":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Sender Info"},"metadata":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Metadata"},"id":{"type":"string","title":"Id"},"user_id":{"type":"string","title":"User Id"},"status":{"$ref":"#/components/schemas/DetectionStatus","default":"pending"},"content_type":{"anyOf":[{"$ref":"#/components/schemas/ContentType"},{"type":"null"}]},"processing_result":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Processing Result"},"processed_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Processed At"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"attachments":{"items":{"$ref":"#/components/schemas/AttachmentResponse"},"type":"array","title":"Attachments","default":[]}},"type":"object","required":["source","id","user_id","created_at"],"title":"DetectedMessageResponse","description":"検知メッセージレスポンス"},"DetectedMessagesListResponse":{"properties":{"messages":{"items":{"$ref":"#/components/schemas/DetectedMessageResponse"},"type":"array","title":"Messages"},"total":{"type":"integer","title":"Total"}},"type":"object","required":["messages","total"],"title":"DetectedMessagesListResponse","description":"検知メッセージ一覧レスポンス"},"DetectionStatus":{"type":"string","enum":["pending","processing","processed","failed"],"title":"DetectionStatus","description":"検知メッセージの処理状態"},"ExecutionProgress":{"properties":{"current_step":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Current Step"},"steps_completed":{"items":{"type":"string"},"type":"array","title":"Steps Completed"},"steps_remaining":{"items":{"type":"string"},"type":"array","title":"Steps Remaining"},"screenshot_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Screenshot Url"}},"type":"object","title":"ExecutionProgress","description":"実行進捗"},"ExecutionStatus":{"type":"string","enum":["pending","executing","awaiting_credentials","completed","failed"],"title":"ExecutionStatus","description":"実行状態"},"ExecutionStatusResponse":{"properties":{"task_id":{"type":"string","title":"Task Id"},"status":{"$ref":"#/components/schemas/ExecutionStatus"},"progress":{"anyOf":[{"$ref":"#/components/schemas/ExecutionProgress"},{"type":"null"}]},"required_service":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Required Service"},"auth_options":{"anyOf":[{"$ref":"#/components/schemas/AuthOptions"},{"type":"null"}]},"execution_result":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Execution Result"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message"}},"type":"object","required":["task_id","status"],"title":"ExecutionStatusResponse","description":"実行状況レスポンス"},"ExtractTextFromURLRequest":{"properties":{"url":{"type":"string","title":"Url"},"wait_for_selector":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Wait For Selector"},"timeout_ms":{"type":"integer","title":"Timeout Ms","default":30000}},"type":"object","required":["url"],"title":"ExtractTextFromURLRequest","description":"URL先テキスト抽出リクエスト"},"ExtractTextFromURLResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"result":{"anyOf":[{"$ref":"#/components/schemas/URLExtractionResult"},{"type":"null"}]},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"ExtractTextFromURLResponse","description":"URL先テキスト抽出レスポンス"},"ExtractionMethod":{"type":"string","enum":["pdf_pdfplumber","pdf_pymupdf","ocr_google_vision","ocr_tesseract","url_playwright","direct_text"],"title":"ExtractionMethod","description":"テキスト抽出方法"},"FriendResponse":{"properties":{"id":{"type":"string","title":"Id"},"display_name":{"type":"string","title":"Display Name"},"avatar_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Avatar Url"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","display_name","created_at"],"title":"FriendResponse","description":"Friend response"},"FriendsListResponse":{"properties":{"friends":{"items":{"$ref":"#/components/schemas/FriendResponse"},"type":"array","title":"Friends"}},"type":"object","required":["friends"],"title":"FriendsListResponse","description":"Friends list response"},"GmailCallbackRequest":{"properties":{"code":{"type":"string","title":"Code"}},"type":"object","required":["code"],"title":"GmailCallbackRequest","description":"Gmail OAuthコールバックリクエスト"},"GmailCallbackResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email"},"message":{"type":"string","title":"Message"}},"type":"object","required":["success","message"],"title":"GmailCallbackResponse","description":"Gmail OAuthコールバックレスポンス"},"GmailDisconnectResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"message":{"type":"string","title":"Message"}},"type":"object","required":["success","message"],"title":"GmailDisconnectResponse","description":"Gmail連携解除レスポンス"},"GmailSetupResponse":{"properties":{"auth_url":{"type":"string","title":"Auth Url"},"message":{"type":"string","title":"Message","default":"Please visit this URL to authorize Gmail access"}},"type":"object","required":["auth_url"],"title":"GmailSetupResponse","description":"Gmail OAuth設定開始レスポンス"},"GmailStatusResponse":{"properties":{"connected":{"type":"boolean","title":"Connected"},"email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email"},"last_sync":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Sync"},"is_active":{"type":"boolean","title":"Is Active","default":false}},"type":"object","required":["connected"],"title":"GmailStatusResponse","description":"Gmail連携状態レスポンス"},"GmailSyncResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"new_messages":{"type":"integer","title":"New Messages"},"message_ids":{"items":{"type":"string"},"type":"array","title":"Message Ids","default":[]}},"type":"object","required":["success","new_messages"],"title":"GmailSyncResponse","description":"Gmail手動同期レスポンス"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"InviteAcceptResponse":{"properties":{"friend_id":{"type":"string","title":"Friend Id"},"room_id":{"type":"string","title":"Room Id"},"message":{"type":"string","title":"Message","default":"Friend added successfully"}},"type":"object","required":["friend_id","room_id"],"title":"InviteAcceptResponse","description":"Invite accept response"},"InviteCreateRequest":{"properties":{"max_uses":{"type":"integer","maximum":100.0,"minimum":1.0,"title":"Max Uses","default":1},"expires_in_hours":{"anyOf":[{"type":"integer","maximum":720.0,"minimum":1.0},{"type":"null"}],"title":"Expires In Hours","default":24}},"type":"object","title":"InviteCreateRequest","description":"Create invite request"},"InviteInfoResponse":{"properties":{"code":{"type":"string","title":"Code"},"creator_name":{"type":"string","title":"Creator Name"},"creator_avatar_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Creator Avatar Url"},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At"},"is_valid":{"type":"boolean","title":"Is Valid"}},"type":"object","required":["code","creator_name","is_valid"],"title":"InviteInfoResponse","description":"Invite info response (for accept page)"},"InviteResponse":{"properties":{"id":{"type":"string","title":"Id"},"code":{"type":"string","title":"Code"},"invite_url":{"type":"string","title":"Invite Url"},"max_uses":{"type":"integer","title":"Max Uses"},"use_count":{"type":"integer","title":"Use Count"},"expires_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Expires At"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","code","invite_url","max_uses","use_count","created_at"],"title":"InviteResponse","description":"Invite response"},"LoginRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","title":"Password"}},"type":"object","required":["email","password"],"title":"LoginRequest","description":"User login request"},"MemberRole":{"type":"string","enum":["owner","admin","member"],"title":"MemberRole","description":"Member role in a room"},"MessageResponse":{"properties":{"id":{"type":"string","title":"Id"},"room_id":{"type":"string","title":"Room Id"},"sender_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sender Id"},"sender_name":{"type":"string","title":"Sender Name"},"sender_type":{"$ref":"#/components/schemas/SenderType"},"content":{"type":"string","title":"Content"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","room_id","sender_name","sender_type","content","created_at"],"title":"MessageResponse","description":"Message response"},"MessageSendRequest":{"properties":{"content":{"type":"string","maxLength":10000,"minLength":1,"title":"Content"}},"type":"object","required":["content"],"title":"MessageSendRequest","description":"Send message request"},"MessageSource":{"type":"string","enum":["done_chat","gmail","line"],"title":"MessageSource","description":"メッセージのソース"},"MessagesListResponse":{"properties":{"messages":{"items":{"$ref":"#/components/schemas/MessageResponse"},"type":"array","title":"Messages"}},"type":"object","required":["messages"],"title":"MessagesListResponse","description":"Messages list response"},"ProvideCredentialsRequest":{"properties":{"service":{"type":"string","title":"Service"},"credentials":{"additionalProperties":{"type":"string"},"type":"object","title":"Credentials"},"save_credentials":{"type":"boolean","title":"Save Credentials","default":true},"is_new_registration":{"type":"boolean","title":"Is New Registration","default":false}},"type":"object","required":["service","credentials"],"title":"ProvideCredentialsRequest","description":"タスク実行中の認証情報提供リクエスト"},"ProvideCredentialsResponse":{"properties":{"task_id":{"type":"string","title":"Task Id"},"status":{"type":"string","title":"Status"},"message":{"type":"string","title":"Message"}},"type":"object","required":["task_id","status","message"],"title":"ProvideCredentialsResponse","description":"認証情報提供レスポンス"},"ReadMarkResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"read_at":{"type":"string","format":"date-time","title":"Read At"}},"type":"object","required":["success","read_at"],"title":"ReadMarkResponse","description":"Read mark response"},"RegisterRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","minLength":8,"title":"Password"},"display_name":{"type":"string","maxLength":100,"minLength":1,"title":"Display Name"}},"type":"object","required":["email","password","display_name"],"title":"RegisterRequest","description":"User registration request"},"ReviseRequest":{"properties":{"revision":{"type":"string","title":"Revision"}},"type":"object","required":["revision"],"title":"ReviseRequest","description":"訂正リクエスト"},"RoomCreateRequest":{"properties":{"name":{"type":"string","maxLength":100,"minLength":1,"title":"Name"},"member_ids":{"items":{"type":"string"},"type":"array","minItems":1,"title":"Member Ids"}},"type":"object","required":["name","member_ids"],"title":"RoomCreateRequest","description":"Create room request"},"RoomMemberResponse":{"properties":{"user_id":{"type":"string","title":"User Id"},"display_name":{"type":"string","title":"Display Name"},"avatar_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Avatar Url"},"role":{"$ref":"#/components/schemas/MemberRole"},"ai_mode":{"$ref":"#/components/schemas/AIMode"},"joined_at":{"type":"string","format":"date-time","title":"Joined At"}},"type":"object","required":["user_id","display_name","role","ai_mode","joined_at"],"title":"RoomMemberResponse","description":"Room member response"},"RoomMembersListResponse":{"properties":{"members":{"items":{"$ref":"#/components/schemas/RoomMemberResponse"},"type":"array","title":"Members"}},"type":"object","required":["members"],"title":"RoomMembersListResponse","description":"Room members list response"},"RoomResponse":{"properties":{"id":{"type":"string","title":"Id"},"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"type":{"$ref":"#/components/schemas/RoomType"},"my_role":{"anyOf":[{"$ref":"#/components/schemas/MemberRole"},{"type":"null"}]},"my_ai_mode":{"anyOf":[{"$ref":"#/components/schemas/AIMode"},{"type":"null"}]},"last_read_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Read At"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Updated At"}},"type":"object","required":["id","type","created_at"],"title":"RoomResponse","description":"Room response"},"RoomType":{"type":"string","enum":["direct","group"],"title":"RoomType","description":"Room type"},"RoomUpdateRequest":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":100,"minLength":1},{"type":"null"}],"title":"Name"}},"type":"object","title":"RoomUpdateRequest","description":"Update room request"},"RoomsListResponse":{"properties":{"rooms":{"items":{"$ref":"#/components/schemas/RoomResponse"},"type":"array","title":"Rooms"}},"type":"object","required":["rooms"],"title":"RoomsListResponse","description":"Rooms list response"},"SenderType":{"type":"string","enum":["human","ai"],"title":"SenderType","description":"Message sender type"},"StorageType":{"type":"string","enum":["local","supabase"],"title":"StorageType","description":"ストレージタイプ"},"TaskResponse":{"properties":{"id":{"type":"string","title":"Id"},"user_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id"},"type":{"$ref":"#/components/schemas/TaskType"},"status":{"$ref":"#/components/schemas/TaskStatus"},"original_wish":{"type":"string","title":"Original Wish"},"proposed_actions":{"items":{"type":"string"},"type":"array","title":"Proposed Actions","default":[]},"execution_result":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Execution Result"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Updated At"}},"type":"object","required":["id","user_id","type","status","original_wish","created_at"],"title":"TaskResponse","description":"タスクレスポンス"},"TaskStatus":{"type":"string","enum":["pending","analyzing","proposed","confirmed","executing","completed","failed","cancelled"],"title":"TaskStatus","description":"タスクのステータス"},"TaskType":{"type":"string","enum":["email","line","purchase","payment","research","travel","other"],"title":"TaskType","description":"タスクの種類"},"TextExtractionResult":{"properties":{"success":{"type":"boolean","title":"Success"},"text":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Text"},"method":{"$ref":"#/components/schemas/ExtractionMethod"},"page_count":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Page Count"},"confidence":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Confidence"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"metadata":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Metadata"},"processing_time_ms":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Processing Time Ms"}},"type":"object","required":["success","method"],"title":"TextExtractionResult","description":"テキスト抽出結果"},"TokenResponse":{"properties":{"access_token":{"type":"string","title":"Access Token"},"token_type":{"type":"string","title":"Token Type","default":"bearer"}},"type":"object","required":["access_token"],"title":"TokenResponse","description":"JWT token response"},"URLExtractionResult":{"properties":{"success":{"type":"boolean","title":"Success"},"text":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Text"},"method":{"$ref":"#/components/schemas/ExtractionMethod"},"page_count":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Page Count"},"confidence":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Confidence"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"metadata":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Metadata"},"processing_time_ms":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Processing Time Ms"},"title":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Title"},"url":{"type":"string","title":"Url"},"final_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Final Url"}},"type":"object","required":["success","method","url"],"title":"URLExtractionResult","description":"URL先コンテンツ抽出結果"},"UserResponse":{"properties":{"id":{"type":"string","title":"Id"},"email":{"type":"string","title":"Email"},"display_name":{"type":"string","title":"Display Name"},"avatar_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Avatar Url"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Updated At"}},"type":"object","required":["id","email","display_name","created_at"],"title":"UserResponse","description":"User profile response"},"UserUpdateRequest":{"properties":{"display_name":{"anyOf":[{"type":"string","maxLength":100,"minLength":1},{"type":"null"}],"title":"Display Name"},"avatar_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Avatar Url"}},"type":"object","title":"UserUpdateRequest","description":"User profile update request"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"WishRequest":{"properties":{"wish":{"type":"string","title":"Wish"},"user_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id"},"tools":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Tools"}},"type":"object","required":["wish"],"title":"WishRequest","description":"ユーザーの願望リクエスト"},"WishResponse":{"properties":{"task_id":{"type":"string","title":"Task Id"},"message":{"type":"string","title":"Message"},"proposed_actions":{"items":{"type":"string"},"type":"array","title":"Proposed Actions"},"proposal_detail":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Proposal Detail"},"requires_confirmation":{"type":"boolean","title":"Requires Confirmation"},"search_results":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Search Results","default":[]}},"type":"object","required":["task_id","message","proposed_actions","requires_confirmation"],"title":"WishResponse","description":"願望に対するレスポンス"}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}}}